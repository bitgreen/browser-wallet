<!--
    An example: 
    - to transfer 1 Bitgreen
    - make a Signature and receive an authentication token

    ## Attention: the example need to be used from https, it does not work opened locally because of the check on target origin (window.location.href)
    ## to use locally you should replace the parameter window.location.href with "*".
-->
<html>
  <h1>Examples for Browser Wallet</h1>
  <hr>
  <h3>Here the basic examples to call the functions of the Browser Wallet.</h3>
  <hr>
  <button id="transferbutton">Transfer 1 Bitgreen</button>
  <button id="signinbutton">Sign In</button>
  <button id="newasset">New Asset</button>
  <button id="balance">Query Balance</button>
  <!-- include the BrowserWallet library-->
  <script type="text/javascript" src="BrowserWallet.js"></script>
  <script>
    // remove previous signin session
    sessionStorage.removeItem("BrowserWalletToken");
    // create class object for BrowserWallet
    let BW= new BrowserWallet();
    let button = document.getElementById("transferbutton");
    button.addEventListener("click", () =>{
      // send 1 BBB to a recipient
      BW.transfer("5HVfcSujPyT2hisdLDQhHXzCDx2e37UBM3h9fW65qkHx4FbN",1,answerCallback);
    }, false);
    let button2 = document.getElementById("signinbutton");
    button2.addEventListener("click", () =>{
        // authenticate signing a random message
        BW.authenticate(answerCallback);
    }, false);
    let button3 = document.getElementById("newasset");
    button3.addEventListener("click", () =>{
        // send extrinsic
        BW.txpallet("assets","create",'[1005,"5GGoUgUtw7tvQyJ7tknapdXkmZnduJbk2RJQNPMKqe7ufRCj",1]',answerCallback);
    },false);
    let button4 = document.getElementById("balance");
    button4.addEventListener("click", () =>{
        // send extrinsic
        console.log("Sending Query");
        BW.querypallet("balances","account",'["5HpZcMvM6bJgoVvC5iBeyctZ3YggsBA9J6T8KAngLomUpotU"]',answerCallback);
    },false);

    // function called after the signing
    function callbackauthentication(answer){
        // the token is stored in the session variable.
        console.log("Authentication token: ",answer);
    }
    function transferCallback(answer) {
        console.log("Transfer Result: ",answer);
    }
     function txCallback(answer) {
        console.log("Pallet Call Result: ",answer);
    }
    // call back function to receive the answer from the wallet
    function answerCallback(answer) {
        console.log("Wallet answer: ",answer);
    }
  </script>
  
</html>
